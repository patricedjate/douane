{
    "sourceFile": "src/Controller/ChefController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1674484951340,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1674485193253,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,12 +5,12 @@\n use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\r\n use Symfony\\Component\\HttpFoundation\\Response;\r\n use Symfony\\Component\\Routing\\Annotation\\Route;\r\n \r\n-class SiteController extends AbstractController\r\n+#[Route('/chef')]\r\n+class ChefController extends AbstractController\r\n {\r\n-    \r\n-    #[Route('/chef', name: 'chef.index')]\r\n+    #[Route('/', name: 'chef.index')]\r\n     public function chef(): Response\r\n     {\r\n         return $this->render('chef/test.html.twig');\r\n     }\r\n"
                },
                {
                    "date": 1674487510849,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,7 +11,7 @@\n {\r\n     #[Route('/', name: 'chef.index')]\r\n     public function chef(): Response\r\n     {\r\n-        return $this->render('chef/test.html.twig');\r\n+        return $this->render('chef/index.html.twig');\r\n     }\r\n }\r\n"
                },
                {
                    "date": 1674488076898,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,17 +1,19 @@\n-<?php\r\n-\r\n-namespace App\\Controller;\r\n-\r\n-use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\r\n-use Symfony\\Component\\HttpFoundation\\Response;\r\n-use Symfony\\Component\\Routing\\Annotation\\Route;\r\n-\r\n-#[Route('/chef')]\r\n-class ChefController extends AbstractController\r\n-{\r\n-    #[Route('/', name: 'chef.index')]\r\n-    public function chef(): Response\r\n-    {\r\n-        return $this->render('chef/index.html.twig');\r\n-    }\r\n-}\r\n+<?php\n+\n+namespace App\\Controller;\n+\n+use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\n+use Symfony\\Component\\HttpFoundation\\Response;\n+use Symfony\\Component\\Routing\\Annotation\\Route;\n+\n+#[Route('/chef')]\n+class ChefController extends AbstractController\n+{\n+    #[Route('/', name: 'app_chef')]\n+    public function index(): Response\n+    {\n+        return $this->render('chef/index.html.twig', [\n+            'controller_name' => 'ChefController',\n+        ]);\n+    }\n+}\n"
                },
                {
                    "date": 1674488116650,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,12 +8,10 @@\n \n #[Route('/chef')]\n class ChefController extends AbstractController\n {\n-    #[Route('/', name: 'app_chef')]\n+    #[Route('/', name: 'chef_Index')]\n     public function index(): Response\n     {\n-        return $this->render('chef/index.html.twig', [\n-            'controller_name' => 'ChefController',\n-        ]);\n+        return $this->render('chef/index.html.twig');\n     }\n }\n"
                },
                {
                    "date": 1677702675951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,17 +1,115 @@\n <?php\n \n namespace App\\Controller;\n \n-use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\n+use App\\Entity\\AgentVisite;\n+use App\\Repository\\UserRepository;\n+use App\\Repository\\FicheRepository;\n+use App\\Repository\\AgentVisiteRepository;\n+use App\\Repository\\RapportEmpotageRepository;\n+use Symfony\\Component\\HttpFoundation\\Request;\n use Symfony\\Component\\HttpFoundation\\Response;\n use Symfony\\Component\\Routing\\Annotation\\Route;\n+use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\n+use Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\IsGranted;\n+use Sensio\\Bundle\\FrameworkExtraBundle\\Configuration\\Security;\n \n #[Route('/chef')]\n class ChefController extends AbstractController\n {\n+    #[isGranted('ROLE_CHEF')]\n+    #[Security(\"is_granted('ROLE_CHEF')\")]\n     #[Route('/', name: 'chef_Index')]\n-    public function index(): Response\n+    public function index(RapportEmpotageRepository $rapport, UserRepository $agent, FicheRepository $ficherepo): Response\n     {\n-        return $this->render('chef/index.html.twig');\n+        if(!$this->getUser()){\n+            return $this->redirectToRoute('app_login');\n+        }\n+        $nombre = count($rapport->findNbre());\n+        $nombreAgent = count($agent->findNbre());\n+        $nombreFiche = count($ficherepo->findNbre());\n+        $NonEffectue = count($rapport->findNbreNon()) - $nombre;\n+        $fiches = $ficherepo->countByDate();\n+        $rapports = $rapport->countByDate();\n+        $dates = [];\n+        $ficheCount = [];\n+        foreach ($fiches as $fiche) {\n+            $dates[] = $fiche['nbrejour'];\n+            $ficheCount[] = $fiche['count'];\n+        }\n+        $rapports = $rapport->countByDate();\n+        $datess = [];\n+        $rapportCount = [];\n+        foreach ($rapports as $rapport) {\n+            $datess[] = $rapport['nbrejour'];\n+            $rapportCount[] = $rapport['count'];\n+        }\n+        return $this->render('chef/index.html.twig',[\n+            \"nombre\"=> $nombre,\n+            \"nombreAgent\"=>$nombreAgent,\n+            \"nombreFiche\"=>$nombreFiche,\n+            \"nonEffectue\"=> $NonEffectue,\n+            \"date\"=>json_encode($dates),\n+            'nbre'=>json_encode($ficheCount),\n+            \"datess\"=>json_encode($datess),\n+            'nbres'=>json_encode($rapportCount)\n+        ]);\n     }\n+    #[isGranted('ROLE_CHEF')]\n+    #[Security(\"is_granted('ROLE_CHEF')\")]\n+    #[Route('/ListeAgent', name: 'chef_ListeAgent')]\n+    public function agent(UserRepository $repository): Response\n+    {\n+        if(!$this->getUser()){\n+            return $this->redirectToRoute('app_login');\n+        }\n+        $agents = $repository->findAllUserByRoles();\n+        return $this->render('chef/ListeAgent.html.twig',[\n+            'agents'=>$agents\n+        ]);\n+    }\n+    #[isGranted('ROLE_CHEF')]\n+    #[Security(\"is_granted('ROLE_CHEF')\")]\n+    #[Route('/ListeFicheTraite/{id}', name: 'ListeFicheTraite')]\n+    public function traite(Request $request, FicheRepository $repository, UserRepository $userRepository): Response\n+    {\n+        if(!$this->getUser()){\n+            return $this->redirectToRoute('app_login');\n+        }\n+        $fiches = $repository->findAllFicheEffectueByUser($request->attributes->get('id'));\n+        $username = $userRepository->findOneBy([\"id\"=>$request->attributes->get('id')])->getNom();\n+        return $this->render('chef/ListeFicheTraite.html.twig',[\n+            'fiches'=>$fiches,\n+            'username'=>$username\n+        ]);\n+    }\n+    #[isGranted('ROLE_CHEF')]\n+    #[Security(\"is_granted('ROLE_CHEF')\")]\n+    #[Route('/ListeFicheNonTraite/{id}', name: 'ListeFicheNonTraite')]\n+    public function nonTraite(Request $request, FicheRepository $repository, UserRepository $userRepository): Response\n+    {\n+        if(!$this->getUser()){\n+            return $this->redirectToRoute('app_login');\n+        }\n+        $fiches = $repository->findAllFicheByUser($request->attributes->get('id'));\n+        $username = $userRepository->findOneBy([\"id\"=>$request->attributes->get('id')])->getNom();\n+        return $this->render('chef/ListeFicheNonTraite.html.twig',[\n+            'fiches'=>$fiches,\n+            'username'=>$username\n+        ]);\n+    }\n+    #[isGranted('ROLE_CHEF')]\n+    #[Security(\"is_granted('ROLE_CHEF')\")]\n+    #[Route(\"/rapport/{id}\",name:\"chef_rapport\")]\n+    public function rapport(Request $request, RapportEmpotageRepository $repository):Response\n+    {\n+        if(!$this->getUser()){\n+            return $this->redirectToRoute('app_login');\n+        }\n+        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')]);\n+        dd($rapport);\n+        return $this->render('chef/rapport.html.twig',[\n+            'rapport'=>$rapport\n+        ]);\n+    }\n }\n"
                },
                {
                    "date": 1677702918744,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n     {\n         if(!$this->getUser()){\n             return $this->redirectToRoute('app_login');\n         }\n-        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')]);\n+        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')])->getConye;\n         dd($rapport);\n         return $this->render('chef/rapport.html.twig',[\n             'rapport'=>$rapport\n         ]);\n"
                },
                {
                    "date": 1677702947534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n     {\n         if(!$this->getUser()){\n             return $this->redirectToRoute('app_login');\n         }\n-        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')])->getConye;\n+        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')])->getContenu();\n         dd($rapport);\n         return $this->render('chef/rapport.html.twig',[\n             'rapport'=>$rapport\n         ]);\n"
                },
                {
                    "date": 1677702980870,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n     {\n         if(!$this->getUser()){\n             return $this->redirectToRoute('app_login');\n         }\n-        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')])->getContenu();\n+        $rapport = $repository->findBy(['id'=>$request->attributes->get('id')]);\n         dd($rapport);\n         return $this->render('chef/rapport.html.twig',[\n             'rapport'=>$rapport\n         ]);\n"
                },
                {
                    "date": 1677703114477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -106,9 +106,8 @@\n         if(!$this->getUser()){\n             return $this->redirectToRoute('app_login');\n         }\n         $rapport = $repository->findBy(['id'=>$request->attributes->get('id')]);\n-        dd($rapport);\n         return $this->render('chef/rapport.html.twig',[\n             'rapport'=>$rapport\n         ]);\n     }\n"
                }
            ],
            "date": 1674484951340,
            "name": "Commit-0",
            "content": "<?php\r\n\r\nnamespace App\\Controller;\r\n\r\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\r\nuse Symfony\\Component\\HttpFoundation\\Response;\r\nuse Symfony\\Component\\Routing\\Annotation\\Route;\r\n\r\nclass SiteController extends AbstractController\r\n{\r\n    \r\n    #[Route('/chef', name: 'chef.index')]\r\n    public function chef(): Response\r\n    {\r\n        return $this->render('chef/test.html.twig');\r\n    }\r\n}\r\n"
        }
    ]
}